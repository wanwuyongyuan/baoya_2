<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>é’¥åŒ™å¼€é”</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Noto+Serif+SC&display=swap');

body {
  margin: 0;
  font-family: 'Noto+Serif+SC', serif;
  background: radial-gradient(circle at center, #3b2f1a 0%, #1e1407 80%);
  color: #f5e7c4;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  height: 100vh;
  line-height: 1.8;
  font-size: 19px;
  user-select: none;
  overflow: hidden;
  padding: 20px;
  box-sizing: border-box;
}

.story {
  max-width: 780px;
  margin-bottom: 60px;
  transition: opacity 0.6s ease;
  min-height: 400px;
}

#key {
  display: inline-block;
  padding: 10px 20px;
  color: #edcb77;
  border: 1px solid rgba(237,203,119,0.5);
  border-radius: 6px;
  cursor: grab;
  background: rgba(60, 47, 26, 0.3);
  transition: transform 0.2s;
}
#key:active {
  cursor: grabbing;
  transform: scale(1.1);
}

#lockhole {
  width: 100px;
  height: 140px;
  border: 2px solid rgba(255,255,200,0.3);
  border-radius: 50px / 70px;
  background: rgba(0,0,0,0.3);
  margin-top: 40px;
  text-align: center;
  line-height: 140px;
  color: rgba(255,255,255,0.2);
  font-size: 14px;
}
#lockhole.glow {
  border-color: #ffd966;
  box-shadow: 0 0 20px #ffd966;
  color: #ffd966;
  transition: 0.5s;
}

.fade-line {
  opacity: 0;
  transform: translateY(4px);
  transition: opacity 0.9s ease, transform 0.6s ease;
}
.fade-line.show {
  opacity: 1;
  transform: translateY(0);
}

#status-bar {
  position: fixed;
  bottom: 0;
  left: 0;
  display: flex;
  align-items: center;
  background: rgba(0,0,0,0.6);
  padding: 5px 10px;
  height: 90px;   /* æ˜ç¡®çŠ¶æ€æ¡é«˜åº¦ */
  z-index: 1000;
}

#status-img {
  height: 80px;   /* æ˜ç¡®å›¾ç‰‡é«˜åº¦ */
  width: auto;     /* ä¿æŒæ¯”ä¾‹ */
  image-rendering: pixelated; /* ä¿æŒåƒç´ æ„Ÿï¼Œé¿å…æ¨¡ç³Š */
  margin-right: 8px;
}

#status-text {
  color: #fff;
  font-size: 18px;
  white-space: nowrap;
}

</style>
</head>
<body>

<div class="story" id="story">
  <p>é‚£ä¸²é’¥åŒ™åœ¨æˆ‘çš„æŒå¿ƒã€‚</p>
  <p>æˆ‘æŠ¬èµ·æ‰‹ä¸­çš„<span id="key" draggable="true">é’¥åŒ™</span>ã€‚</p>
  <p>ï¼ˆå°†é’¥åŒ™æ”¾å…¥é—¨é”ï¼‰</p>
</div>

<div id="lockhole">é”å­”</div>

<audio id="unlockSound" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_15f3031b93.mp3?filename=unlock-door-6042.mp3"></audio>

<div id="status-bar">
  <img src="9riji_Piskel.png" alt="ä¸»è§’" id="status-img">
  <span id="status-text">ä½ åœ¨æ­¤ä½ç½®ï¼ˆäº®å…‰ç‰ˆï¼‰</span>
</div>

<script>
const key = document.getElementById('key');
const lockhole = document.getElementById('lockhole');
const story = document.getElementById('story');
const sound = document.getElementById('unlockSound');
const statusImg = document.getElementById('status-img');

key.addEventListener('dragstart', e => {
  e.dataTransfer.setData('text/plain', 'key');
  setTimeout(() => key.style.opacity = '0.5', 0);
});
key.addEventListener('dragend', () => {
  key.style.opacity = '1';
});

lockhole.addEventListener('dragover', e => {
  e.preventDefault();
  lockhole.classList.add('glow');
});
lockhole.addEventListener('dragleave', () => {
  lockhole.classList.remove('glow');
});

lockhole.addEventListener('drop', e => {
  e.preventDefault();
  const data = e.dataTransfer.getData('text/plain');
  if (data === 'key') {
    // ğŸ”¹ å¼€é”åé¦ˆ
    lockhole.innerHTML = '<span style="font-size:20px; color:#ffe89e;">å’”å“’â€”â€”</span>';
    sound.play();
    lockhole.classList.remove('glow');

    // ğŸ”¹ æ›¿æ¢çŠ¶æ€æ¡å°å›¾
    statusImg.src = '9jisi1_Piskel.png';

    // ğŸ”¹ éšè—é”å­” & æ·¡å‡ºåŸå‰§æƒ…
    lockhole.style.display = 'none';
    story.style.opacity = '0';

    setTimeout(() => {
      story.innerHTML = ''; // æ¸…ç©ºæ—§å†…å®¹
      const lines = [
        'åšé‡çš„é“é—¨ç¼“ç¼“å¼€å¯ã€‚',
        'å‡ é“å†·é£çŒå…¥ï¼Œç«å…‰æ‘‡æ›³ï¼Œæ˜ å¾—æˆ‘ä»¬è„¸è‰²æƒ¨ç™½ã€‚ç©ºæ°”ä¸­å¤¹ç€åœŸå’Œè¡€çš„è…¥å‘³ï¼Œæˆ‘å¿ä¸ä½å’³å—½ã€‚',
        'æˆ‘ä»¬å°å¿ƒå‰è¡Œï¼Œç»ˆäºçœ‹åˆ°äº†å‡ºå£çš„æœˆå…‰ã€‚',
        'æ´å£èšç€ä¸€ç¾¤æ¥é›¾å±±æ—…æ¸¸çš„VIPè€å¹´äººï¼Œå¤±å»äº†å¯¼æ¸¸çš„ä»–ä»¬ä¸çŸ¥é“ä¸‹ä¸€æ­¥è¯¥åšä»€ä¹ˆã€‚',
        'å°éªä½å£°é—®æˆ‘ï¼šâ€œå¥šå¦ï¼Œè¿™é‡Œâ€¦â€¦æœ‰ä½ å¦ˆå¦ˆå—ï¼Ÿâ€',
        'â€œæ²¡æœ‰â€¦â€¦â€æˆ‘ç´§æ¡åŒæ‹³ï¼Œå£°éŸ³å“½å’½ã€‚',
        'å°ç”°ä¸Šå‰å¯¹æˆ‘ä»¬ä½å£°è¯´ï¼šâ€œè¦ä¸æˆ‘å¸¦ä»–ä»¬å…ˆèµ°ï¼Ÿâ€',
        'è¿™æ—¶æœ‰äº›è€äººä¹Ÿè®¤å‡ºäº†å¥¹ã€‚',
        'â€œå¥½ï¼Œä½ è·¯æ„Ÿæœ€å¥½ã€‚â€å°å¾é“ã€‚',
        'å°ç”°ç‚¹ç‚¹å¤´ï¼Œé¢†ç€é‚£äº› VIP è€å¹´äººæ¶ˆå¤±åœ¨é›¾ä¸­ã€‚',
        'ç°åœ¨åªå‰©æˆ‘ä»¬ä¸‰äººã€‚',
        '<span id="toFinal" style="font-weight:bold; color:#ffd966; cursor:pointer;">æˆ‘ä»¬æ·±å¸ä¸€å£æ°”ï¼Œé‡æ–°è¸å…¥å±±æ´ã€‚</span>'
      ];

      const frag = document.createDocumentFragment();
      lines.forEach(line => {
        const p = document.createElement('p');
        p.className = 'fade-line';
        p.style.textAlign = 'left';
        p.innerHTML = line;
        frag.appendChild(p);
      });
      story.appendChild(frag);

      // é€è¡Œæ·¡å…¥
      requestAnimationFrame(() => {
        const ps = story.querySelectorAll('.fade-line');
        let idx = 0;
        function revealOne() {
          if (idx < ps.length) {
            ps[idx].classList.add('show');
            idx++;
            setTimeout(revealOne, 700);
          } else {
            story.style.minHeight = '';
            const toFinal = document.getElementById('toFinal');
            if (toFinal) {
              const goFinal = () => window.location.href = '10final.html';
              toFinal.addEventListener('click', goFinal);
              toFinal.addEventListener('touchend', goFinal);
            }
          }
        }
        story.style.opacity = '1';
        revealOne();
      });
    }, 500); // å¼€é”æ·¡å‡ºæ—¶é—´
  }
});
</script>

</body>
</html>
